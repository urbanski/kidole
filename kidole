#!/usr/bin/env python
import json
import pprint
import sys
import re

def load_fingerprints():
    json_data = open("webapps.ky").read()
    
    for line in json_data:
        if line[0:1] == "#":
            json_data.replace(line,"")
    data = json.loads(json_data)
    return data

def main():
    url_list = sys.stdin.readlines()
    fpdata = load_fingerprints()
    
    for url in url_list:
        for signature_group in fpdata:
            for app_group in fpdata[signature_group]:
                for app_name in app_group:
                    for sig in app_group[app_name]:
                        if (re.search(sig, url)):
                            print "%s|%s|%s|%s" % (signature_group, app_name, sig, url)
                            
#application entrypoint
main()